<h2>Register</h2>

<p>Select role:</p>
<label><input type="radio" name="role" value="rider" checked onchange="toggleRole()"> Rider</label>
<label><input type="radio" name="role" value="driver" onchange="toggleRole()"> Driver</label>

<div id="riderFields" style="display:block">
  <input type="text" id="riderUsername" placeholder="Username"><br>
  <input type="text" id="riderName" placeholder="Name"><br>
  <input type="email" id="riderEmail" placeholder="Email"><br>
  <input type="text" id="riderPhone" placeholder="Phone"><br>
  <p>Payment Method:</p>
  <label><input type="radio" name="riderPayment" value="cash"> Cash</label>
  <label><input type="radio" name="riderPayment" value="card"> Card</label>
  <label><input type="radio" name="riderPayment" value="wallet"> Wallet</label>
</div>

<div id="driverFields" style="display:none">
  <input type="text" id="driverUsername" placeholder="Username"><br>
  <input type="text" id="driverName" placeholder="Name"><br>
  <input type="email" id="driverEmail" placeholder="Email"><br>
  <input type="text" id="driverPhone" placeholder="Phone"><br>
  <input type="text" id="driverBank" placeholder="Bank ID"><br>
  <p>Vehicle Type:</p>
  <label><input type="radio" name="driverVehicle" value="sedan"> Sedan</label>
    <label><input type="radio" name="driverVehicle" value="suv"> SUV</label>
      <label><input type="radio" name="driverVehicle" value="van"> Van</label>
  <label><input type="radio" name="driverVehicle" value="truck"> Truck</label>
  <label><input type="radio" name="driverVehicle" value="motorcycle"> Motorcycle</label>
</div>

<button onclick="register()">Register</button>
<p id="status"></p>

<script>
function toggleRole() {
  let role = document.querySelector('input[name="role"]:checked').value;
  if (role == "rider") {
    document.getElementById("riderFields").style.display = "block";
  } else {
    document.getElementById("riderFields").style.display = "none";
  }

  if (role == "driver") {
    document.getElementById("driverFields").style.display = "block";
  } else {
    document.getElementById("driverFields").style.display = "none";
  }
}

function register() {
  let role = document.querySelector('input[name="role"]:checked').value;
  let data = {};
  data.role = role;

  if (role === "rider") {
    data.username = document.getElementById("riderUsername").value;
    data.name = document.getElementById("riderName").value;
    data.email = document.getElementById("riderEmail").value;
    data.phone = document.getElementById("riderPhone").value;
    data.payment = document.querySelector('input[name="riderPayment"]:checked')?.value;
  } else {
    data.username = document.getElementById("driverUsername").value;
    data.name = document.getElementById("driverName").value;
    data.email = document.getElementById("driverEmail").value;
    data.phone = document.getElementById("driverPhone").value;
    data.bank = document.getElementById("driverBank").value;
    data.vehicle = document.querySelector('input[name="driverVehicle"]:checked')?.value;
  }

  fetch("/registerUser", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(text => {
    document.getElementById("status").innerText = text;
    window.location.href = "/login";
  })
  .catch(err => {
    document.getElementById("status").innerText = "Error registering.";
    console.error(err);
  });
}
</script>